(function(c,a){c.namespace("Platform.winport.diy.form");var b=new a.Class(a.widget.Dialog,{init:function(d){if(!d.handler){c.error("form handler is not speicified")}d=c.extend({draggable:true},d);d.contentSuccess=c.proxy(this,"__contentSuccess");d.confirm=c.proxy(this,"__confirm");d.close=d.cancel=c.proxy(this,"__cancel");d.beforeClose=c.proxy(this,"__beforeClose");this.handler=d.handler;this.handler.dialog=this;this.handlerName=d.handlerName;this.parent.init.call(this,d)},__contentSuccess:function(){var d=this;this.form=c("form:first",this.node);this.__handleDefaultSubmit();this.__initFormHandler()},__handleDefaultSubmit:function(){var d=this;this.node.delegate("input:text","keydown",function(f){if(f.keyCode===13){d.__confirm();return false}})},__initFormHandler:function(){var e=this.handler,f=this.form,d=f.data("formConfig")||{},g=this.config.formData;e.init(f,d,g,this);c.log((this.handlerName||"FormHandler")+" initialized")},__confirm:function(){var d=this.handler;if(!d){return}if(d.validate&&!d.validate(this.form)){return false}if(d.submit){return d.submit(this.form)}},__cancel:function(){var d=this.handler;if(d&&d.cancel&&d.cancel(this.form)===false){return}this.close()},__beforeClose:function(){var d=this.handler;if(d&&d.beforeClose){return d.beforeClose(this.form)}}});b.open=function(d){return new b(d)};a.diy.FormDialog=b})(jQuery,Platform.winport);