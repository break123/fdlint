(function(b,a){var c={};c.resizeImage=(function(){return function(f,h,g){if(!b.isPlainObject(h)){h={width:h,height:h}}if(h.size){h.width=h.height=h.size}g=g||h.defaultImage;b(f).each(function(){var i=this,j=new Image();j.onload=function(){if(g&&e(this)){i.src=g}else{d(i,h.width,h.height,this,h.force)}j.onload=null;h.success&&h.success(i)};j.src=i.src})};function e(f){return f.width<=1&&f.height<=1}function d(j,g,n,i,f){var m=i.width,k=i.height,l=false,o=0;if(!m||!k){return}if(!g||!n){l=!!g;o=g||n}else{l=m*n-k*g>=0,o=l?g:n}if(l&&(m>o||f)){k=o*k/m;m=o}if(!l&&(k>o||f)){m=o*m/k;k=o}m=Math.round(m);k=Math.round(k);j.width=m;j.height=k;b(j).css({width:m+"px",height:k+"px"})}})();c.htmlTemplate=function(g,f){var e=g.data("html-template"),d=null;if(!e){d=b("textarea.html-template",g);e=d.length?d.val():g.html();g.data("html-template",e)}g.html(f?b.util.substitute(e,f):e)};c.sweetTemplate=function(g,d,e,f){b.use("web-sweet",function(){g=b(g);var i=g.data("sweet-template"),h=null;if(!i){if(!(typeof d==="string")){h=b("textarea.sweet-template",g);f=e;e=d;d=h.length?h.val():g.html()}i=FE.util.sweet(d);g.data("sweet-template",i)}g.html(i.applyData(e));f&&f()})};c.positionFixed=function(d,m){m=m||{};if(!b.util.ua.ie6&&!m.force){return}d=b(d);d.each(function(){var o=b(this),n=parseInt(o.css(m.bottom?"bottom":"top"),10)||0;o.css("position","absolute");o.data("positionFixed",n)});var j=b(window),i=j.scrollTop(),e=null,l=m.show||function(n){n.fadeIn()},g=function(){f(500)},h=function(){f(50)};j.bind("scroll",g);j.bind("resize",h);j.bind("position-fixed",g);d.bind("remove",function(){j.unbind("scroll",g);j.unbind("resize",h);j.unbind("position-fixed",g)});d.bind("position-fixed",g);function f(n){if(!m.bottom&&i===j.scrollTop()){return}d.hide();e&&clearTimeout(e);e=setTimeout(function(){e=null;i=j.scrollTop();k(i)},n)}function k(n){d.each(function(){var p=b(this),o=p.data("positionFixed")||0,q=m.bottom?j.height()-o-p.height():o;p.css("top",q+n);l(p)})}};c.colorPicker=function(d){b.use("ui-colorbox",function(){b(d).each(function(){var e=b(this),f=b("span",e),g=b("input.value",e);f.css("background-color",g.val());e.colorbox({color:g.val(),select:function(i,h){g.val(h.color);f.css("background-color",h.color);e.triggerHandler("select",h);b(this).colorbox("hide")}})})})};c.datePicker=(function(){return function(h){b(h).each(function(){g(b(this))})};function g(h){var l=b("span.text",h),k=b("input.value",h),j=f(k.val()),i={picker:h,text:l,value:k};h.datepicker({date:j,select:function(n,m){e(m.date,i)},beforeShow:function(){return !h.hasClass("disabled")},closable:true});h.bind("dateselect",function(n,m){e(m,i)});j?e(j,i):l.text("请选择日期")}function e(i,j){var h=j.picker,k=b.util.substitute("{0}-{1}-{2}",[i.getFullYear(),i.getMonth()+1,i.getDate()]);j.text.text(k);j.value.val(d(i));h.data("date",i);h.trigger("datechange",i)}function f(j){var h=null,i=parseInt(j.trim(),10);if(i){h=new Date();h.setTime(i);return h}}function d(h){return h.getTime()}})();c.showLoading=function(d,e){var g={loadingClassName:"wp-loading",txtClassName:"wp-loading-txt",txt:"正在加载..",css:{}},f=b.extend({},g,e);var h=b.trim(f.txt)===""?"":'<span class="'+f.txtClassName+'">'+f.txt+"</span>",i=b('<div class="'+f.loadingClassName+'">'+h+"</div>");d.html(i)};a.UI=c;b.add("wp-ui")})(jQuery,Platform.winport);