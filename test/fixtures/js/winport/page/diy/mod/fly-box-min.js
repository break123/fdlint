(function(c,a){var b=a.diy.ModBox;var d={init:function(){this.fly=c("div.winport-fly");this.flyBox=c(this.template);this.initModBox();this.handleFlyBoxDisplay();this.initFlyBar()},initModBox:function(){var f=this,e="div.box-shim,div.box-bar,a.box-fly-adder";c(e,this.fly).remove();c("div.box-adder",this.fly).remove();this.fly.delegate("div.mod-box","reloaded loaded",function(){var g=c("div.mod",this);c(e,this).remove();f.flyBox.appendTo(g);setTimeout(function(){f.loading=false},100)});this.fly.delegate("div.mod-box","reloading",function(){f.flyBox.detach();f.loading=true})},handleFlyBoxDisplay:function(){setTimeout(c.proxy(this,"_handleFlyBoxDisplay"),100)},_handleFlyBoxDisplay:function(){var e=this;this.fly.delegate("div.mod","mouseenter",function(){if(e.loading){return}var f=c(this);e.showFlyBox(f)});this.fly.delegate("div.mod","mouseleave",function(){e.hideFlyBox()})},showFlyBox:function(f){var g=this.flyBox,e=f.height();e&&g.height(e);if(!c("div.fly-box",f).length){f.append(g)}g.addClass("fly-box-in")},hideFlyBox:function(){this.flyBox.removeClass("fly-box-in")},initFlyBar:function(){var e=c("div.fly-bar",this.flyBox);e.bind("click dblclick",false);this.handleFlyStateBtn(e);this.handleFlyBarEdit(e)},handleFlyStateBtn:function(g){var e=this,f=this.flyBox;g.delegate("a.minimize","click",function(){e.getModBox().addClass("mod-box-minimize")});g.delegate("a.normalize","click",function(){e.getModBox().removeClass("mod-box-minimize")})},handleFlyBarEdit:function(e){e.delegate("a.edit","click",function(){var f=c(this).closest("div.mod-box");b.edit(f)})},getModBox:function(){return this.flyBox.closest("div.mod-box")},template:'<div class="fly-box">	<div class="fly-shim"></div>	<div class="fly-bar">		<div class="b-body">			<a href="#" title="设置" class="edit"></a>			<a href="#" title="最小化" class="minimize"></a>			<a href="#" title="还原" class="normalize"></a>		</div>	</div></div>'};a.PageContext.register("~FlyBox",d)})(jQuery,Platform.winport);