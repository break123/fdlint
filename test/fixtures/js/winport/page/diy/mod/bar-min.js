(function(f,u){var v=u.diy,i=u.UI,k=f.util.ua.ie6,l=f.util.ua.ie,a=f.util.ua.ie67,j=v.BoxOperateChecker,o,r,p=f(["left","up","down","right","edit","del"]),s={};var t={init:function(){o=g();p.each(function(w,x){s[x]=f("a."+x,o)});if(a){f("div.mod-box").each(function(w,x){c(x)})}m();e();f("div.mod-box:not(.ui-portlets-placeholder)").live("movestart",function(){h()}).live("ddstop movestop",function(w){c(this);a&&f(this).mouseover();q(this)}).live("reloaded",function(w){a&&f(this).mouseover()});f("div.mod").live("afterinit",function(){a&&f(this).mouseover()})}};function g(){var x=f("<div>",{"class":"box-bar fd-hide"}),y=[],w=["◊Û“∆","…œ“∆","œ¬“∆","”““∆","…Ë÷√","…æ≥˝"];p.each(function(z,A){y.push('<a href="#" class="'+A+'" title="'+w[z]+'"></a>')});x.html(y.join(""));return x}function m(){var x=f("div.mod-box:not(.ui-portlets-placeholder)"),w=f("#winport-content");x.live("mouseenter",function(y){if(f("div.mod",this).hasClass("wp-top-nav")){d(this);o.css("visibility","hidden");s.edit.css("visibility","visible");return false}else{o.css("visibility","visible")}b(this)});x.live("mouseleave",function(){n(this);h()});x.live("dblclick",function(z){var y=f(this);if(f("div.mod",this).hasClass("wp-top-nav")){return}try{v.BoxOperateHandler.edit.operate(y,z)}catch(A){f.log("dbl edit error: "+A)}return false})}function b(x){if(r!==x){n(r)}var w=f("div.box-shim",x);w.addClass("box-shim-in");c(x);w.stop();w.animate({opacity:0.5},200,function(){d(x)});r=x}function c(x){if(a){x=f(x);var w=f("div.box-shim",x),y=x.height();if(f("div.m-body",x).length>0){w.height(y-8)}else{w.height(y)}}}function d(w){q(w);o.appendTo(w);o.removeClass("fd-hide");o.css("display","")}function n(x){var w=f("div.box-shim",x);w.removeClass("box-shim-in");w.stop();w.css("opacity",0)}function h(){o.addClass("fd-hide")}function q(w){w=f(w);if(w.length===0){w=o.parents("div.mod-box")}p.each(function(x,y){if(j.check(w,y,true).pass){s[y].css("display","")}else{s[y].css("display","none")}})}function e(){f(".box-bar a").live("click",function(y){var x=f(this).closest("div.mod-box"),w=this.className;try{v.BoxOperateHandler[w].operate(x,y)}catch(z){f.log("Box Operate Error : "+z)}return false})}u.diy.BoxBar=t;u.PageContext.register("~BoxBar",t)})(jQuery,Platform.winport);